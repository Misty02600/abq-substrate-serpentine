# --- 主配置文件 ---
# 使用 hydra-list-sweeper 进行参数扫描:
#   - grid_params: 笛卡尔积（所有组合）
#   - list_params: 一一配对（zip）
# 派生值使用自定义 resolver:
#   - ${imul:${a},2}: 整数乘法 (a * 2)
#   - ${div:${a},2}: 除法 (a / 2)

defaults:
  - _self_
  - override hydra/sweeper: list   # 启用 list sweeper

hydra:
  # mode: RUN（单次运行）或 MULTIRUN（参数扫描）
  mode: MULTIRUN
  # 禁用 Hydra 输出目录（不生成 multirun/ 和 outputs/）
  run:
    dir: .
  sweep:
    dir: .
    subdir: .
  output_subdir: null  # 不创建 .hydra 子目录

  sweeper:
    # 笛卡尔积参数
    grid_params:
      # substrate.porosity: 0.2,0.3,0.4,0.5,0.6   # 5 个值
      # pores.T_delta: 0.02,0.06,0.1              # 3 个值
      # pores.random_seed: 1,2,3,4,5              # 5 个值
      # 总计: 5 × 3 × 5 = 75 组合

    # Zip 配对参数
    # list_params:
    #   substrate.n_rows: 8,16,32
    #   substrate.n_cols: 16,32,64

# --- 基底配置 ---
substrate:
  type: solid                                        # solid（实心）或 porous（多孔）

  # 通用参数
  depth: 0.8
  seed_size: 0.05

  # 多孔基底参数（type=porous 时使用）
  n_rows: 16
  n_cols: ${imul:${substrate.n_rows},2}             # 派生值: n_rows * 2 = 32
  porosity: 0.5                                      # 默认值，被 sweeper 覆盖
  square_size: ${div:2,${substrate.n_rows}}         # 派生值: 2 / n_rows = 0.125
  edge_seed_size: 0.05                               # 导线区域边细化尺寸

  # 实心基底参数（type=solid 时使用）
  length: 8.0
  width: 11.0

# --- 加载配置 ---
loading:
  u1: 0.1
  u2: 0.5

# --- 导线配置 ---
wire:
  w: 0.5
  l_1: 6.0
  l_2: 6.0
  m: 1
  seed_size: 0.05
  rotation_angle: 0
  rotation_center: center  # 可选: origin, center, 或 [x, y, z]
  has_end_caps: false
  flip_vertical: true

# --- 孔隙配置 ---
pores:
  use_standard_circles: false
  T_xi: 0
  T_delta: 0.06                                   # 默认值，被 sweeper 覆盖
  random_seed: 1                                  # 默认值，被 sweeper 覆盖

# --- 计算配置 ---
computing:
  num_cpus: 4
  enable_restart: false

# --- 分析配置 ---
analysis:
  stabilization_magnitude: 0.002
  adaptive_damping_ratio: 0.2

# --- 相互作用配置 ---
interaction:
  use_cohesive: false

# --- 输出配置 ---
output:
  global_output: false

# --- 命名配置 ---
naming:
  custom_params:
    - n_rows
    - porosity
    - T_xi
    - T_delta
    - random_seed

# --- 分析步配置（可选，空列表使用默认两步）---
steps:
  # Step-1: 预加载步
  - step_type: static
    max_num_inc: 150
    initial_inc: 0.1
    min_inc: 1.0e-08
    max_inc: 0.5
    enable_restart: false
    restart_intervals: 1
    set_time_incrementation: true

  # Step-2: 拉伸步
  - step_type: static
    max_num_inc: 10000
    initial_inc: 0.02
    min_inc: 1.0e-08
    max_inc: 0.05
    enable_restart: false
    restart_intervals: 2
    set_time_incrementation: false
