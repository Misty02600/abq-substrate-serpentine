# System Patterns

## System Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                      Entry Points                            │
├─────────────────────────────────────────────────────────────┤
│  build_solid_serpentine.py   batch_generate_and_inp.py      │
│  generate_from_json.py       generate_frome_ini.py          │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    src/config/                               │
│  ├── parse_config.py      - INI 配置解析                     │
│  ├── process_config.py    - 配置处理和验证                   │
│  ├── filename_codec.py    - 文件名编解码                     │
│  └── modelname_format.py  - 模型命名格式化                   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    src/model/                                │
│  ├── substrate.py   - 基底几何创建（实心/多孔）              │
│  ├── wire.py        - 蛇形导线创建（PI-Cu-PI）              │
│  ├── pores.py       - 孔隙生成（标准/随机分布）             │
│  └── assembly.py    - 装配和约束设置                        │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                 common_scripts/                              │
│  ├── inp_writer.py        - INP 文件修改                    │
│  ├── job_generator.py     - 作业生成                        │
│  ├── submit.py            - 作业提交                        │
│  └── viewport_setup.py    - 视口设置                        │
└─────────────────────────────────────────────────────────────┘
```

## Key Technical Decisions

### 1. 配置文件格式
- 使用 INI 格式，易于阅读和编辑
- 支持多值参数（逗号分隔），自动展开参数组合
- 支持 origin 坐标的特殊解析（分号分隔多个坐标）

### 2. 模型命名规范
- 包含分布类型前缀：`std`（标准）或 `uni`（均匀）
- 自动包含变化的参数值
- 支持自定义命名参数配置

### 3. 蛇形导线结构
- 三层复合结构：PI-Cu-PI
- 支持壳单元和实体单元两种建模方式
- 参数化控制：宽度(w)、节距(l_1)、高度(l_2)、周期数(m)

### 4. 基底类型
- **实心基底**：简单矩形实体
- **多孔基底**：支持标准圆孔排列和随机分布

## Design Patterns

### 模块化设计
- 几何创建与装配分离
- 配置解析与模型构建分离
- 后处理独立于模型创建

### 函数式接口
- 每个主要功能对应一个明确的函数
- 参数通过函数参数传递，不依赖全局状态
- 返回 ABAQUS 对象（Part、Model 等）供后续操作

### 路径处理
- 使用 `pathlib.Path` 进行跨平台路径处理
- 自动检测脚本目录，支持多种运行方式

## Component Relationships

```
config.ini
    ↓ parse
ConfigDict
    ↓ expand
[ModelConfig, ...]  # 参数组合列表
    ↓ for each
Model
    ├── Substrate Part
    ├── Wire Part
    ├── Assembly
    ├── Materials
    ├── Steps
    ├── Loads/BCs
    └── Job
```
